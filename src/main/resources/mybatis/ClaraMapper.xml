<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yu.springboot_jdbc_mybatis.mappers.ClaraMapper">
  <update id="UpdateMenutitle">
    update menu set menucomment=#{menucomment} where menutitle=#{menutitle}
  </update>
  <update id="UpadteMenured">
    update menu set menured=menured+1 where menutitle=#{menutitle}
  </update>
  <update id="Fortitleid">
    update menu set titleid=#{titleid} where menutitle=#{menutitle}
  </update>
    <update id="UpdateUserPwd">
      update users set upwd=#{upwd} where uname=#{uname} and uemile=#{uemile}
    </update>
  <update id="UpdateSongNumber">
         update song set ofNumber=ofNumber-1
  </update>
  <select id="QueryAllMenuComments" resultType="com.yu.springboot_jdbc_mybatis.pojo.Menu">
    select * from menu order by menucomment desc limit 0,4;
  </select>
    <select id="QueryAllMenuYear" resultType="com.yu.springboot_jdbc_mybatis.pojo.Menu">
    select * from menu where year(menudate)>=#{year} LIMIT 0,4
  </select>
  <select id="QueryAllMenuCount" resultType="Integer">
   SELECT count(*) from menu
  </select>
  <select id="QueryLists" resultType="com.yu.springboot_jdbc_mybatis.pojo.Menu">
    select * from menu where rightto=1
  </select>
    <select id="QueryByDetails" resultType="com.yu.springboot_jdbc_mybatis.pojo.Menu">
    select * from menu where menutitle=#{menutitle}
    </select>
  <select id="queryMenuList" resultType="com.yu.springboot_jdbc_mybatis.pojo.Menu">
    select * from menu
  </select>
  <select id="Queryuser" resultType="com.yu.springboot_jdbc_mybatis.pojo.User">
    select * from users where uname=#{uname}
  </select>
    <select id="QueryComment" resultType="com.yu.springboot_jdbc_mybatis.pojo.Topiccomments">
      select * from topiccomments where topictitle=#{topictitle}
    </select>
    <select id="QueryRepleComments" resultType="com.yu.springboot_jdbc_mybatis.pojo.RepleComments">
      select * from replecomments where repletitle=#{repletitle}
    </select>
    <select id="Querynickname" resultType="com.yu.springboot_jdbc_mybatis.pojo.User">
      SELECT uid,nickname from users
    </select>
  <select id="QueryuserOnly" resultType="java.lang.String">
    select* from users where uname=#{uname} or uemile=#{uemile} or nickname=#{nickname}
  </select>
    <select id="QueryTopiccommentscomment" resultType="java.lang.Integer">
      select count(*) from topiccomments where topictitle=(select menutitle from menu where menutitle=#{menutitle})
    </select>
  <select id="QueryById" resultType="java.lang.String">
    select menutitle from menu where menuid=#{menuid}
  </select>
  <select id="QueryByIdall" resultType="java.lang.String">
    select menutitle from menu where menuid in<foreach item="item" index="index" collection="list" open="(" separator="," close=")">
    #{item}
  </foreach>
  </select>
    <select id="QueryemileByNickname" resultType="java.lang.String">
      SELECT uemile from users where nickname=#{nickname}
    </select>
  <select id="QueryLuckUser" resultType="com.yu.springboot_jdbc_mybatis.pojo.LuckUser">
    SELECT * from luckuser where nickname=#{nickname}
  </select>
  <select id="QuerySongUrl" resultType="com.yu.springboot_jdbc_mybatis.pojo.Song">
        SELECT * from song
  </select>
  <select id="QueryByDetaileLike" resultType="com.yu.springboot_jdbc_mybatis.pojo.Menu">
    <bind name="menutitle" value="'%' + menutitle + '%'"/>
    select * from menu where menutitle like #{menutitle}
  </select>
  <insert id="AddMenu" parameterType="com.yu.springboot_jdbc_mybatis.pojo.Menu">
    INSERT into menu VALUES(#{menuid},#{menutitle},#{menudate},#{menured},#{menucomment},#{titleid},#{info1},#{info2},#{rightto},#{detailstext})
  </insert>
  <insert id="addComment">
    INSERT into topiccomments VALUES(#{id},#{topicname},#{topictitle},#{topictext},#{topicdate},#{topicred})
  </insert>
    <insert id="ReplyComment">
      INSERT into replecomments VALUES(#{id},#{commentid},#{repleid},#{repleType},#{repletitle},#{repletext},#{fromusid},#{touid},#{repledate})
    </insert>
  <insert id="addUser">
    INSERT into users value(#{uid},#{uname},#{upwd},#{uemile},#{upower},#{nickname})
  </insert>
    <insert id="addLuckUser">
      INSERT into luckuser (id,nickname,sing) value(0,#{nickname},#{sing})
    </insert>
    <insert id="addSongUrl">
      insert into song values(0,#{songurl},60)
    </insert>
    <delete id="deleteMenu" parameterType="com.yu.springboot_jdbc_mybatis.pojo.Menu">
    delete from menu where titleid=#{id}
  </delete>
  <delete id="deleteDetails" parameterType="com.yu.springboot_jdbc_mybatis.pojo.Menu">
    delete from menu where menuid=#{menuid}
  </delete>
  <delete id="deleteMenuAll" parameterType="com.yu.springboot_jdbc_mybatis.pojo.Menu">
    delete from
    menu
    where
    menuid IN
    <foreach item="item" index="index" collection="list" open="(" separator="," close=")">
      #{item}
    </foreach>
  </delete>
  <delete id="deletetopiccomments">
    delete from topiccomments where topictitle=#{topictitle}
  </delete>
  <delete id="deletetopiccommentsall">
        delete from topiccomments where topictitle in  <foreach item="item" index="index" collection="list" open="(" separator="," close=")">
    #{item}
  </foreach>
  </delete>
  <delete id="DeleteLuckUser">
    delete from luckuser
  </delete>
  <delete id="DeletSongUrl">
    delete from song
  </delete>
</mapper>